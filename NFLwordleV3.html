<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NFL Wordle Showdown — Results</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0b0e14; --panel:#11161f; --muted:#8ea0b4; --text:#e9eef5; --rule:#253043;
  --accent:#5dd0ff; --accent-ink:#052c3a; --ok:#3bd37f; --bad:#ff6b6b; --warn:#ffd166;
}
html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 ui-sans-serif,system-ui;}
.wrap{max-width:1100px;margin:22px auto;padding:0 14px}

/* SCOREBOARD */
.scoreboard{
  display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:12px;
  background:linear-gradient(180deg,#0e131c 0%, #0d1522 100%);
  border:1px solid var(--rule);
  border-radius:16px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,.25);
  max-width:860px;margin:0 auto;
}
.team{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:end}
.name{font-weight:900;font-size:22px;text-transform:uppercase}
.score{
  font-family:monospace;
  font-size:40px;background:#0a0f17;border:2px solid #1a263a;border-radius:12px;
  padding:4px 12px;min-width:80px;text-align:center;
}
.center{text-align:center;display:flex;flex-direction:column;gap:6px}
.banner{font-weight:900;font-size:12px;background:var(--accent);color:var(--accent-ink);
  padding:4px 10px;border-radius:999px}

/* TABLE */
.tables{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:18px}
.side h3{margin:0 0 8px 0;font-size:16px;font-weight:900}
table{width:100%;border-collapse:separate;border-spacing:0 8px}
thead th{font-size:11px;color:var(--muted);font-weight:800;text-align:center}
thead th:first-child{text-align:left;padding-left:8px}
tbody td{
  background:var(--panel);
  border:1px solid var(--rule);
  padding:8px 6px;
}
tbody tr td:first-child{border-radius:12px 0 0 12px}
tbody tr td:last-child{border-radius:0 12px 12px 0}

.roundLabel{
  width:54px;text-align:left;padding-left:10px;
  color:#cfeaff;font-weight:900;
}

/* RESULT BOXES */
.boxCell{text-align:center}

.box{
  display:flex;
  align-items:center;
  justify-content:center;
  width:30px;
  height:30px;
  border-radius:8px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.06);
  font-weight:900;
  font-size:20px; /* arrow size */
  color:var(--warn);
}

.ok{
  background:rgba(59,211,127,.20);
  border-color:rgba(59,211,127,.5);
  color:white;
}

.bad{
  background:rgba(255,107,107,.20);
  border-color:rgba(255,107,107,.5);
}

.footer{margin-top:14px;color:var(--muted);font-size:12px;text-align:center}
</style>
</head>

<body>
<div class="wrap">

<section class="scoreboard">
  <div class="team">
    <div class="name" id="leftName">LEFT</div>
    <div class="score" id="leftScore">0</div>
  </div>

  <div class="center">
    <div>NFL WORDLE</div>
    <div class="banner">FIRST TO 5 WINS!</div>
  </div>

  <div class="team">
    <div class="name" id="rightName">RIGHT</div>
    <div class="score" id="rightScore">0</div>
  </div>
</section>

<div class="tables">

<section class="side">
<h3 id="leftHeader">Left</h3>
<table>
<thead>
<tr>
<th>Rnd</th><th>Pick</th><th>Conf</th><th>Div</th><th>Team</th><th>Pos</th><th>Age</th><th>Pts</th>
</tr>
</thead>
<tbody id="leftBody"></tbody>
</table>
</section>

<section class="side">
<h3 id="rightHeader">Right</h3>
<table>
<thead>
<tr>
<th>Rnd</th><th>Pick</th><th>Conf</th><th>Div</th><th>Team</th><th>Pos</th><th>Age</th><th>Pts</th>
</tr>
</thead>
<tbody id="rightBody"></tbody>
</table>
</section>

</div>

<div class="footer">Refresh to pull latest CSV data.</div>
</div>

<script>
const CSV = {
Selections:"https://docs.google.com/spreadsheets/d/e/2PACX-1vR7-NfeL-PNHti9NS4z2Rk_i1MRyNwcrF8yYTA6VzpvFcdg3j5KxHQp2SPltrkuhgNXB9Q3vE0iU75K/pub?gid=642123740&single=true&output=csv",
CurrentSelection:"https://docs.google.com/spreadsheets/d/e/2PACX-1vR7-NfeL-PNHti9NS4z2Rk_i1MRyNwcrF8yYTA6VzpvFcdg3j5KxHQp2SPltrkuhgNXB9Q3vE0iU75K/pub?gid=2147341155&single=true&output=csv",
CurrentStandings:"https://docs.google.com/spreadsheets/d/e/2PACX-1vR7-NfeL-PNHti9NS4z2Rk_i1MRyNwcrF8yYTA6VzpvFcdg3j5KxHQp2SPltrkuhgNXB9Q3vE0iU75K/pub?gid=224409268&single=true&output=csv"
};

const ROUNDS=5;

function loadCSV(url,opts={}) {
return new Promise((res,rej)=>{
Papa.parse(url,{download:true,...opts,complete:res,error:rej});
});
}

function makeBox({color=null,arrow=null}={}) {
const box=document.createElement("span");
box.className="box";

if(color==="ok") box.classList.add("ok");
if(color==="bad") box.classList.add("bad");

if(arrow) box.textContent = arrow==="up" ? "↑" : "↓";

return box;
}

function parseNum(v){
if(!v || v==="#N/A") return null;
const n=Number(String(v).replace(/[, ]/g,""));
return Number.isFinite(n)?n:null;
}

function norm(v){ return String(v||"").trim().toUpperCase(); }

function grade(pick,official){

if(!pick.Selection) return null;

const cat=(a,b)=> norm(a)===norm(b) ? "ok" : "bad";

const ageMine=parseNum(pick.Age);
const ageTrue=parseNum(official.Age);

const ptsMine=parseNum(pick.Points);
const ptsTrue=parseNum(official.Points);

return {
pick:cat(pick.Selection,official.Selection),
conf:cat(pick.Conference,official.Conference),
div:cat(pick.Division,official.Division),
team:cat(pick.Team,official.Team),
pos:cat(pick.Position,official.Position),

age: ageMine==null ? {} :
(ageMine===ageTrue ? {color:"ok"} :
{arrow: ageTrue>ageMine ? "up":"down"}),

pts: ptsMine==null ? {} :
(ptsMine===ptsTrue ? {color:"ok"} :
{arrow: ptsTrue>ptsMine ? "up":"down"})
};
}

function render(tbody,picks,official){
tbody.innerHTML="";

for(let i=0;i<ROUNDS;i++){

const p=picks[i]||{};
const g=grade(p,official);

const tr=document.createElement("tr");

const add=(node)=>{
const td=document.createElement("td");
td.className="boxCell";
td.appendChild(node);
tr.appendChild(td);
};

const r=document.createElement("td");
r.className="roundLabel";
r.textContent=i+1;
tr.appendChild(r);

if(!g){
for(let x=0;x<7;x++) add(makeBox());
tbody.appendChild(tr);
continue;
}

add(makeBox({color:g.pick}));
add(makeBox({color:g.conf}));
add(makeBox({color:g.div}));
add(makeBox({color:g.team}));
add(makeBox({color:g.pos}));
add(makeBox(g.age));
add(makeBox(g.pts));

tbody.appendChild(tr);
}
}

async function boot(){

const sel=(await loadCSV(CSV.Selections,{header:false})).data;

const left=[],right=[];
for(let r=1;r<=ROUNDS;r++){
const row=sel[r]||[];

left.push({
Selection:row[1],Position:row[2],Age:row[3],Points:row[4],
Conference:row[5],Division:row[6],Team:row[7]
});

right.push({
Selection:row[9],Position:row[10],Age:row[11],Points:row[12],
Conference:row[13],Division:row[14],Team:row[15]
});
}

const offRow=(await loadCSV(CSV.CurrentSelection,{header:true})).data[0];

const official={
Selection:offRow.Selection || offRow.Name,
Conference:offRow.Conference,
Division:offRow.Division,
Team:offRow.Team,
Position:offRow.Position,
Age:offRow.Age,
Points:offRow.Points || offRow["Fantasy Points"]
};

const standings=(await loadCSV(CSV.CurrentStandings,{header:false})).data;

document.getElementById("leftName").textContent=standings?.[0]?.[0] || "Left";
document.getElementById("rightName").textContent=standings?.[0]?.[1] || "Right";
document.getElementById("leftScore").textContent=standings?.[1]?.[0] || "0";
document.getElementById("rightScore").textContent=standings?.[1]?.[1] || "0";

document.getElementById("leftHeader").textContent=document.getElementById("leftName").textContent;
document.getElementById("rightHeader").textContent=document.getElementById("rightName").textContent;

render(document.getElementById("leftBody"),left,official);
render(document.getElementById("rightBody"),right,official);
}

boot();
</script>
</body>
</html>
